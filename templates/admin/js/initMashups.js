var qlik;var curApp;var rootPath=window.location.hostname;var portUrl="80";if(window.location.port==""){    if("https:" == window.location.protocol)        portUrl="443";    else{        portUrl="80";    }}else    portUrl=window.location.port;var pathRoot="//localhost:4848/extensions/";if(portUrl!="4848")    pathRoot="//"+rootPath+":"+portUrl+"/resources/";var config = {    host: window.location.hostname,    prefix: "/",    port: window.location.port,    isSecure: "https:" === window.location.protocol};require.config( {    waitSeconds:0,    baseUrl: ( config.isSecure ? "https://" : "http://" ) + config.host + ( config.port ? ":" + config.port : "" ) + config.prefix + "resources",    paths: {        jquery: pathRoot +'mdemo/templates/admin/js/libs/jquery-2.1.1.min',        "appl":pathRoot +'mdemo/templates/admin/js/app',        "demo":   pathRoot +'mdemo/templates/admin/js/demo.min',        "config": pathRoot +'mdemo/templates/admin/js/app.config',        "jarvis": pathRoot +'mdemo/templates/admin/js/smartwidgets/jarvis.widget.min',        "boot"  : pathRoot +"mdemo/templates/admin/js/bootstrap/bootstrap.min",        "smart": pathRoot +"mdemo/templates/admin/js/notification/SmartNotification.min",        "pie"  : pathRoot +"mdemo/templates/admin/js/plugin/easy-pie-chart/jquery.easy-pie-chart.min",        "spark": pathRoot +"mdemo/templates/admin/js/plugin/sparkline/jquery.sparkline.min",        "vald" : pathRoot +"mdemo/templates/admin/js/plugin/jquery-validate/jquery.validate.min",        "maske": pathRoot +"mdemo/templates/admin/js/plugin/masked-input/jquery.maskedinput.min",        "sele" : pathRoot +"mdemo/templates/admin/js/plugin/select2/select2.min",        //"slid" : pathRoot +"mdemo/templates/admin/js/plugin/bootstrap-slider/bootstrap-slider.min",        "mbbr" : pathRoot +"mdemo/templates/admin/js/plugin/msie-fix/jquery.mb.browser.min",        "fast" : pathRoot +"mdemo/templates/admin/js/plugin/fastclick/fastclick.min",        "voic" : pathRoot +"mdemo/templates/admin/js/speech/voicecommand.min",        "punc" : pathRoot +"mdemo/templates/admin/js/plugin/jquery-touch/jquery.ui.touch-punch.min",        "edit" : pathRoot +"mdemo/templates/admin/js/editable"    },    shim: {        'appl': {            deps: ['jquery'],            exports: 'appl'        },        'smart': {            deps: ['jquery'],            exports: 'smart'        },        'config': {            deps: ['jquery'],            exports: 'config'        },        'boot': {            deps: ['jquery'],            exports: 'boot'        },        'pie': {            deps: ['jquery'],            exports: 'pie'        },        'spark': {            deps: ['jquery'],            exports: 'spark'        },        'vald': {            deps: ['jquery'],            exports: 'vald'        },        'maske': {            deps: ['jquery'],            exports: 'maske'        },        'sele': {            deps: ['jquery'],            exports: 'sele'        },//        'slid': {//            deps: ['jquery','boot'],//            exports: 'slid'//        },        'mbbr': {            deps: ['jquery'],            exports: 'mbbr'        },        'fast': {            deps: ['jquery'],            exports: 'fast'        },        'voic': {            deps: ['jquery'],            exports: 'voic'        },        'punc': {            deps: ['jquery'],            exports: 'punc'        },        'edit': {            deps: ['jquery'],            exports: 'edit'        },        'jarvis': {            deps: ['jquery'],            exports: 'jarvis'        },        'demo': {            deps: ['jquery'],            exports: 'demo'        }    }} )( ["js/qlik","jquery","config","boot" ,"smart","pie"  ,"spark","vald" ,"maske","sele" ,"mbbr" ,"fast" ,"voic" ,"punc","edit" ,"jarvis","appl","demo"], function ( qlikview,$ ){    qlik=qlikview;//    var app;//    if(getURLParameter('app')!='undefined'){//        console.log("app in : " +getURLParameter('app'));//        app = qlikview.openApp(decodeURI(getURLParameter('app')), config);//        curApp=app;//        qlikview.setOnError( function ( error ) {//            alert( error.message );//        } );//        restoreObj(app);//    }});function makeDroppy() {    $(".qvplaceholder").on('dragover', function (event) {        event.preventDefault();        $(this).addClass("drop-hover");    }).on('dragleave', function (event) {        event.preventDefault();        $(this).removeClass("drop-hover");    }).on('drop', function (event) {        var app =curApp;        $(this).removeClass("drop-hover");        event.preventDefault();        $(this).empty();        var id = event.originalEvent.dataTransfer.getData('text').split("#")[1];        var type = event.originalEvent.dataTransfer.getData('text').split("#")[0];        $(this).removeClass('qv');        $(this).removeClass('qvtarget');        if (type != 'snapshot') {            curApp.getObject($('#CurrentSelections'), 'CurrentSelections');            localStorage.setItem(this.id + '#' + app.id, id);            curApp.getObject(this, id).then(function (o) {            });        }        else {            localStorage.setItem(this.id + '#' + app.id, id + '#snap');            curApp.getSnapshot(this, id).then(function () {            });        }    })}function restoreObj(){    makeEdit();    if(typeof(qlik)=='undefined') {        setTimeout(function () {            restoreObj()        }, 100)        return;    }    var app;    if(getURLParameter('app')!='undefined'){        console.log("app in : " +getURLParameter('app'));        app = qlik.openApp(decodeURI(getURLParameter('app')), config);        curApp=app;        qlik.setOnError( function ( error ) {            alert( error.message );        } );    }    makeDroppy();    if(getURLParameter('app')!='null')        setTimeout(function(){            var appId=decodeURI(getURLParameter('app'));            $('#CurrentSelections').empty();            curApp.getObject($('#CurrentSelections'),'CurrentSelections');            $('.qvplaceholder').each(function( index ) {                if(appId && localStorage.getItem(this.id+'#'+ appId) && localStorage.getItem(this.id+'#'+ appId).split('#').length==1 ){                    $(this).empty();                    $(this).removeClass('qv');                    $(this).removeClass('qvtarget');                    curApp.getObject(this, localStorage.getItem(this.id+'#'+ appId)).then(function () {                    });                }else if(appId && localStorage.getItem(this.id+'#'+ appId) && localStorage.getItem(this.id+'#'+ appId).split('#').length>1){                    $(this).empty();                    $(this).removeClass('qv');                    $(this).removeClass('qvtarget');                    curApp.getSnapshot(this, localStorage.getItem(this.id+'#'+ appId).split('#')[0]).then(function () {                    });                }                else{                    $(this).empty();                    $(this).addClass('qv');                    $(this).addClass('qvtarget');                }            })        },100);}function getURLParameter(a) {    return (RegExp(a + "=(.+?)(&|$)").exec(location.search) || [null, null])[1]}